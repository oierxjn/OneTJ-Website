---
title: 开发环境配置
date: 2025-01-29 00:00:00
permalink: /develop/env
categories:
  - 开发
tags:
  - 开发
  - 环境
description: 介绍 OneTJ 项目的开发环境配置。
---

## 开发环境要求

### 必需工具

| 工具 | 版本要求 | 说明 |
|------|---------|------|
| **Flutter SDK** | 3.6.2+ | 推荐 3.27.4 鸿魔版 |
| **Dart SDK** | 3.6.2+ | 随 Flutter 安装 |
| **Git** | 2.0+ | 版本控制 |
| **IDE** | - | VS Code 或 Android Studio |

### 可选工具

| 工具 | 说明 |
|------|------|
| **FVM** | Flutter 版本管理工具 |
| **鸿蒙 Command Line Tools** | 编译鸿蒙版本 |

## FVM 安装

### 为什么使用 FVM

- 管理多个 Flutter 版本
- 确保团队成员使用相同版本
- 方便切换不同项目的 Flutter 版本

### 安装 FVM

::: code-group

```sh [macOS]
brew tap leoafarias/fvm
brew install fvm

# 或通过 pub
dart pub global activate fvm
```

```sh [Linux]
dart pub global activate fvm

# 或通过 snap
snap install fvm
```

```sh [Windows]
choco install fvm

# 或通过 pub
dart pub global activate fvm
```

:::

### FVM 常用命令

```bash
# 安装 Flutter 版本
fvm install 3.27.4

# 列出已安装版本
fvm list

# 设置项目使用的版本
fvm use 3.27.4

# 使用指定版本运行命令
fvm flutter run

# 全局设置默认版本
fvm global 3.27.4
```

## Flutter 安装

### 鸿魔版 Flutter

OneTJ 使用支持鸿蒙的 Flutter 版本：

```bash
# 克隆鸿魔版 Flutter
git clone -b oh-3.27.4-dev https://gitcode.com/openharmony-tpc/flutter_flutter.git

# 移动到 FVM 版本目录
# macOS: ~/.fvm/versions/
# Windows: %USERPROFILE%\fvm\versions\
```

### 官方版 Flutter

如果不需要鸿蒙支持，可以使用官方版本：

```bash
# 下载官方 Flutter
# https://flutter.dev/docs/get-started/install

# 或使用 FVM 安装
fvm install 3.24.0
```

## IDE 配置

### VS Code

1. 安装 VS Code
2. 安装扩展：
   - **Flutter** (Flutter 官方扩展)
   - **Dart** (Dart 语言支持)

#### 配置 FVM 路径

创建 `.vscode/settings.json`：

```json
{
  "dart.flutterSdkPath": ".fvm/flutter_sdk",
  "search.exclude": {
    "**/.fvm": true
  },
  "files.watcherExclude": {
    "**/.fvm": true
  },
  "dart.lineLength": 100
}
```

### Android Studio

1. 安装 Android Studio
2. 安装 Flutter 和 Dart 插件
3. 配置 Flutter SDK 路径：
   - Settings → Languages & Frameworks → Flutter
   - Flutter SDK path: 设置为 FVM 的 Flutter 路径

## 环境验证

### Flutter Doctor

```bash
fvm flutter doctor
```

### 完整输出示例

```
[✓] Flutter (Channel unknown, 3.27.4, on macOS 14.5 23F79)
    • Flutter version 3.27.4
    • Upstream repository unknown
    • Framework revision abc123 (5 days ago)
    • Engine revision def456

[✓] Android toolchain - develop for Android devices
    • Android SDK at /Users/xxx/Library/Android/sdk
    • Platform android-34, build-tools 34.0.0
    • Java binary at: /Applications/Android Studio.app/...
    • Java version OpenJDK Runtime Environment

[✓] Xcode - develop for iOS and macOS
    • Xcode at /Applications/Xcode.app/...
    • Xcode 15.4, Build version 15F31d
    • CocoaPods version 1.14.3

[✓] Chrome - develop for the web
    • Chrome at /Applications/Google Chrome.app/...

[✓] Android Studio
    • Android Studio at /Applications/Android Studio.app/...
    • Flutter plugin installed
    • Dart plugin installed

[✓] VS Code
    • VS Code at /Applications/Visual Studio Code.app
    • Flutter extension installed
    • Dart extension installed

[✓] Connected device
    • macOS (desktop) • macos • darwin-arm64
    • Chrome (web)    • chrome • web-javascript
```

## 常见问题

### FVM 命令找不到

```bash
# 确认 FVM 已安装
which fvm

# 或添加到 PATH
# macOS/Linux: ~/.pub-cache/bin 或 ~/.local/bin
# Windows: %LOCALAPPDATA%\Pub\Cache\bin
```

### Flutter 版本不匹配

```bash
# 检查项目配置的版本
cat .fvm/fvm_config.json

# 安装对应版本
fvm install <version>
```

### 依赖安装失败

```bash
# 清除缓存
fvm flutter pub cache repair

# 重新安装
fvm flutter pub get
```

### iOS 模拟器无法启动

```bash
# 检查 Xcode 是否正确安装
sudo xcode-select --switch /Applications/Xcode.app/...

# 重新安装 CocoaPods
sudo gem install cocoapods
```

## 开发工具推荐

### 终端工具

| 工具 | 说明 |
|------|------|
| **iTerm2** | macOS 终端替代 |
| **Windows Terminal** | Windows 终端 |
| **Tabby** | 跨平台终端 |

### 调试工具

| 工具 | 说明 |
|------|------|
| **Dart DevTools** | Flutter 官方调试工具 |
| **Flutter Inspector** | VS Code 内置 Widget 检查器 |

### API 测试

| 工具 | 说明 |
|------|------|
| **Postman** | API 测试工具 |
| **curl** | 命令行 HTTP 工具 |

## 推荐设置

### VS Code 设置

```json
{
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll": true
  },
  "dart.lineLength": 100,
  "files.autoSave": "afterDelay",
  "files.autoSaveDelay": 1000
}
```

### Git 配置

```bash
# 设置默认分支名
git config --global init.defaultBranch main

# 设置用户信息
git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"
```
