---
title: 项目运行
date: 2025-01-29 00:00:00
permalink: /guide/quickstart/run
categories:
  - 指南
tags:
  - 指南
  - 快速开始
description: 克隆并运行 OneTJ 项目。
---

## 获取项目代码

### 克隆仓库

```bash
git clone https://github.com/oierxjn/OneTJ.git
cd OneTJ
```

### 检查分支

```bash
# 查看当前分支
git branch

# 切换到指定分支（如需要）
git checkout <branch-name>
```

## 安装依赖

### 使用 FVM（推荐）

```bash
fvm flutter pub get
```

### 不使用 FVM

```bash
flutter pub get
```

## local_packages 拉取

项目包含 `local_packages` 目录，用于存放特殊处理的 Flutter 插件（如 `flutter_inappwebview`）。

::: tip 说明

默认情况下，仓库中的 `local_packages` 已经构建完成，可以直接使用。如需重新构建，请按以下步骤操作。

:::

### flutter_inappwebview 拉取流程

```bash
# 进入 local_packages 目录
cd local_packages

# 克隆指定分支
git clone -b br_v6.1.5_ohos https://gitcode.com/openharmony-sig/flutter_inappwebview.git

# 删除 .git 目录，避免与主项目的 .git 冲突
rm -rf flutter_inappwebview/.git

# 返回项目根目录
cd ../
```

## 生成序列化代码

项目使用 `json_serializable` 自动生成 JSON 序列化代码。

::: tip 说明

一般来说，仓库已经构建完成，可以跳过这一步。

:::

```bash
# 生成序列化代码
fvm dart run build_runner build

# 或不使用 fvm
dart run build_runner build
```

生成后会创建 `*.g.dart` 文件，如：

- `lib/models/api_response.g.dart`
- `lib/models/data/code2token.g.dart`
- `lib/models/data/student_info_net_data.g.dart`

::: warning 注意事项

请勿手动编辑 `*.g.dart` 文件，这些文件由 `build_runner` 自动生成。

:::

## 运行项目

### 查看可用设备

```bash
fvm flutter devices
```

输出示例：

```
3 connected devices:
  macOS (desktop)           • macos  • darwin-arm64   • macOS 14.5
  Chrome (web)              • chrome • web-javascript • Google Chrome 120.0
  Edge (web)                • edge   • web-javascript • Microsoft Edge
```

### 运行应用

::: code-group

```sh [使用 FVM]
# 运行到默认设备
fvm flutter run

# 指定设备运行
fvm flutter run -d macos
fvm flutter run -d chrome
fvm flutter run -d <device-id>
```

```sh [不使用 FVM]
flutter run
```

:::

### 调试模式

```bash
# 启用详细日志
fvm flutter run --verbose

# 启用 Dart DevTools
fvm flutter run --devtools
```

## 开发模式

### 热重载

在应用运行时，修改代码后：

- 按 `r` 键：热重载
- 按 `R` 键：热重启
- 按 `q` 键：退出应用

### Debug 模式

```bash
fvm flutter run --debug
```

### Release 模式

```bash
fvm flutter run --release
```

## 构建应用

### Android APK

```bash
fvm flutter build apk --release
```

生成的 APK 位于 `build/app/outputs/flutter-apk/` 目录。

### iOS IPA

```bash
fvm flutter build ios --release
```

### Web

```bash
fvm flutter build web --release
```

生成的文件位于 `build/web/` 目录。

### Windows

```bash
fvm flutter build windows --release
```

### macOS

```bash
fvm flutter build macos --release
```

## 常见问题

### 依赖安装失败

```bash
# 清除缓存后重新安装
fvm flutter pub cache repair
fvm flutter pub get
```

### 代码生成失败

```bash
# 清理后重新生成
fvm flutter clean
fvm dart run build_runner build --delete-conflicting-outputs
```

### 运行时崩溃

- 检查是否已生成序列化代码
- 检查 `local_packages` 是否正确配置
- 查看日志确认具体错误原因
